## å‰è¨€

æŠ€æœ¯æ–‡ç« ï¼Œå°¤å…¶æ˜¯å‰ç«¯æŠ€æœ¯æ–‡ç« å…·æœ‰æ—¶æ•ˆæ€§ã€‚

å¦‚æ–‡ä¸­æåˆ°çš„éƒ¨åˆ†å†…å®¹å‡ºç°*break change*æˆ–å‡ºç°å†…å®¹é”™è¯¯ï¼ˆæ–‡å­—é”™è¯¯/é”™è¯¯çš„ç†è®ºæè¿°ï¼‰ï¼Œä¸ºå°½å¯èƒ½é¿å…å¯¹åé¢çš„è¯»è€…é€ æˆå›°æ‰°ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œå¸Œæœ›åœ¨æ–‡ç« çš„è¯„è®ºåŒºæˆ–ä»£ç ä»“åº“issuesä¸­äºˆä»¥æŒ‡æ­£ï¼Œååˆ†æ„Ÿè°¢ã€‚

## æ‘˜è¦

æœ¬æ–‡ä¸»è¦ä»‹ç»äº†ä¸€ç§åŸºäº`Web Animations API`å®ç°çš„**å…ƒç´ æ–œæŠ›åŠ¨ç”»**è§£å†³æ–¹æ¡ˆã€‚

æœ¬æ–‡ç›¸æ¯”äºå…¶ä»–æ–¹æ¡ˆä¸åŒçš„æ˜¯ï¼šä¸ºäº†ä½¿ä»£ç ç»“æ„æ›´ç´§å‡‘ï¼Œå¤ç”¨æ›´æ–¹ä¾¿ï¼Œæœ¬æ–‡æ²¡æœ‰é‡‡å–`@keyframes`çš„æ–¹å¼å£°æ˜åŠ¨ç”»ï¼Œä¹Ÿä¸éœ€è¦åœ¨`html`éƒ¨åˆ†å£°æ˜ä»»ä½•æ ‡ç­¾ï¼Œè€Œæ˜¯ç›´æ¥é‡‡ç”¨`class`ç±»çš„æ–¹å¼ç”¨JSé›†ä¸­å¤„ç†DOMå…ƒç´ çš„æŒ‚è½½ã€æ ·å¼é…ç½®ã€åŠ¨ç”»æ’­æ”¾ã€‚

åœ¨ä½¿ç”¨æ—¶åªéœ€è¦ï¼š

```js
const moveBall = new MoveBall({startDom, endDom})
moveBall.freeThrow()
```

## æ•ˆæœé¢„è§ˆ

![GIF 2024-2-25 0-17-02](assets/60è¡ŒJSé€Ÿé€šè´­ç‰©è½¦å°çƒæ–œæŠ›åŠ¨ç”»/GIF 2024-2-25 0-17-02.gif)

## å®ç°æ€è·¯

1. ç¡®å®šèµ·ç‚¹åæ ‡å’Œç»ˆç‚¹åæ ‡
2. æ ¹æ®èµ·æ­¢åæ ‡ç¡®å®šæ–œæŠ›è¿åŠ¨çš„è´å¡å°”æ›²çº¿å…¬å¼
3. åŠ¨ç”»æ’­æ”¾å®Œåå›æ”¶DOMå…ƒç´ 

## ä»£ç å®ç°ï¼ˆé™„ç”¨ä¾‹ï¼‰

```js
// MoveBall.js
class MoveBall {
    constructor({ startDom, endDom }) {
        this.startXy = MoveBall.getCenterCoordinates(startDom);
        this.endXy = MoveBall.getCenterCoordinates(endDom);
        this.verticalDom = MoveBall.cerateVerticalDom(startDom);
        this.horizontalDom = MoveBall.createHorizontalDom();
        this.verticalDom.appendChild(this.horizontalDom);
    }
    static ballW = 30;
    static ballH = 30;
    static getCenterCoordinates(domElement) {
        const rect = domElement.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;
        return { x: centerX, y: centerY };
    }
    static cerateVerticalDom(startDom) {
        const startXy = MoveBall.getCenterCoordinates(startDom);
        const verticalDom = document.createElement('div');
        verticalDom.style.position = 'fixed';
        verticalDom.style.top = `${startXy.y - MoveBall.ballH / 2}px`;
        verticalDom.style.left = `${startXy.x - MoveBall.ballW / 2}px`;
        verticalDom.style.zIndex = '999';
        return verticalDom;
    }
    static createHorizontalDom() {
        const horizontalDom = document.createElement('div');
        horizontalDom.style.width = `${MoveBall.ballW}px`;
        horizontalDom.style.height = `${MoveBall.ballH}px`;
        horizontalDom.style.borderRadius = '50%';
        horizontalDom.style.background = 'lightgreen';
        return horizontalDom;
    }
    getOffsetXy() {
        return {
            x: this.endXy.x - this.startXy.x,
            y: this.endXy.y - this.startXy.y,
        };
    }
    freeThrow() {
        document.body.appendChild(this.verticalDom);
        let verticalEasing =
            this.startXy.y < this.endXy.y ? 'cubic-bezier(.44,-1.43,1,1)' : 'cubic-bezier(0,0,.76,1.92)';
        let verticalAnimate = this.verticalDom.animate(
            [{ transform: `translate3d(0, ${this.getOffsetXy().y}px, 0)` }],
            {
                easing: verticalEasing,
                duration: 800,
                iterations: 1,
            }
        );
        this.horizontalDom.animate([{ transform: `translate3d(${this.getOffsetXy().x}px, 0, 0)` }], {
            easing: 'linear',
            duration: 800,
            iterations: 1,
        });
        verticalAnimate.onfinish = () => {
            this.verticalDom.remove();
        };
    }
}

```

**ç”¨ä¾‹**

```html
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <style>
            #d1,
            #d2,
            #d3 {
                width: 100px;
                height: 100px;
            }
            #d1 {
                background: lightsalmon;
                position: fixed;
                top: 30%;
            }
            #d2 {
                background: lightblue;
                position: fixed;
                top: 80%;
                left: 0;
            }
            #d3 {
                background: red;
                position: fixed;
                top: 50%;
                left: 50%;
            }
        </style>
    </head>
    <body>
        <div id="d1"></div>
        <div id="d2"></div>
        <div id="d3"></div>
        <script src="./MoveBall.js"></script>
        <script>
            const d1 = document.getElementById('d1');
            const d2 = document.getElementById('d2');
            const d3 = document.getElementById('d3');
            d1.onclick = function (e) {
                let moveball = new MoveBall({
                    startDom: d1,
                    endDom: d3,
                });
                moveball.freeThrow();
            };
            d2.onclick = function (e) {
                let moveball = new MoveBall({
                    startDom: d2,
                    endDom: d3,
                });
                moveball.freeThrow();
            };
        </script>
    </body>
</html>

```

## æ–œæŠ›è¿åŠ¨çš„åˆ†è§£

æ–œæŠ›è¿åŠ¨çš„æ•ˆæœå®é™…ä¸Šæ˜¯ç”±æ°´å¹³è¿åŠ¨å’Œå‚ç›´è¿åŠ¨ç»„åˆè€Œæˆçš„ã€‚

åœ¨æ°´å¹³æ–¹å‘ä¸Šï¼Œå°çƒåšåŒ€é€Ÿçš„å¹³ç§»è¿åŠ¨ã€‚

å‚ç›´æ–¹å‘ä¸Šï¼Œå°çƒè¿åŠ¨è½¨è¿¹å–å†³äºèµ·ç‚¹åæ ‡å’Œç»ˆç‚¹åæ ‡çš„é«˜ä½å·®ã€‚

**æ³¨æ„å“ˆï¼Œå› ä¸º`getBoundingClientRect()`è¿”å›å€¼æ˜¯ç›¸å¯¹äºè§†å›¾çª—å£çš„å·¦ä¸Šè§’æ¥è®¡ç®—çš„ï¼Œæ‰€ä»¥å½“è¿”å›çš„yå€¼è¶Šå¤§ï¼Œä»£è¡¨è¿™ä¸ªå…ƒç´ è§†è§‰ä¸Šå¤„åœ¨è¶Šä½çš„ä½ç½®ã€‚**

ç”±æ­¤æˆ‘ä»¬å¯ä»¥å½’çº³å‡ºï¼š

å¦‚æœèµ·ç‚¹çš„çºµåæ ‡ **å°äº** ç»ˆç‚¹çš„çºµåæ ‡ï¼Œåˆ™èµ·ç‚¹ç›®æ ‡åœ¨å‚ç›´æ–¹å‘ä¸Š**é«˜äº**ç»ˆç‚¹ç›®æ ‡ï¼ˆç”¨ä¾‹ä¸­d1ï¼‰ã€‚æ­¤æ—¶æ–œæŠ›è¿åŠ¨çš„è½¨è¿¹åº”éµå¾ªï¼šå…ˆåå‘è¿œç¦»èµ·ç‚¹ç›®æ ‡å†æ¥è¿‘ç»ˆç‚¹ç›®æ ‡ï¼Œå…¶è´å¡å°”æ›²çº¿ä¸º`cubic-bezier(.44,-1.43,1,1)`ï¼ˆvia [cubic-bezier(.44,-1.43,1,1) âœ¿ cubic-bezier.com](https://cubic-bezier.com/#.44,-1.43,1,1)ï¼‰ã€‚ï¼ˆä¸¾ä¾‹ï¼šèµ·ç‚¹çºµåæ ‡100ï¼Œç»ˆç‚¹çºµåæ ‡200ï¼Œåˆ™å…¶çºµåæ ‡å˜åŒ–è§„å¾‹ç±»ä¼¼äºï¼š100=>80=>200ï¼‰

å¦‚æœèµ·ç‚¹çš„çºµåæ ‡ **å¤§äº** ç»ˆç‚¹çš„çºµåæ ‡ï¼Œåˆ™èµ·ç‚¹ç›®æ ‡åœ¨å‚ç›´æ–¹å‘ä¸Š**ä½äº**ç»ˆç‚¹ç›®æ ‡ï¼ˆç”¨ä¾‹ä¸­d2ï¼‰ã€‚æ­¤æ—¶æ–œæŠ›è¿åŠ¨çš„è½¨è¿¹åº”éµå¾ªï¼šè¾¾åˆ°ç»ˆç‚¹ç›®æ ‡åå†è¿œç¦»ç»ˆç‚¹ç›®æ ‡ï¼Œç„¶åå†æ¬¡æ¥è¿‘ç»ˆç‚¹ç›®æ ‡ï¼Œå…¶è´å¡å°”æ›²çº¿ä¸º`cubic-bezier(0,0,.76,1.92)`ï¼ˆvia [cubic-bezier(0,0,.76,1.92) âœ¿ cubic-bezier.com](https://cubic-bezier.com/#0,0,.76,1.92)ï¼‰ã€‚ï¼ˆä¸¾ä¾‹ï¼šèµ·ç‚¹çºµåæ ‡300ï¼Œç»ˆç‚¹çºµåæ ‡200ï¼Œåˆ™çºµåæ ‡å˜åŒ–è§„å¾‹ç±»ä¼¼äºï¼š300=>200=>180=>200ï¼‰

## æ€»ç»“

å®ç°è¿™ä¸ªæ•ˆæœå‰ï¼Œæˆ‘ä¸æ˜¯æ²¡æŸ¥é˜…è¿‡ç”¨`@keyframes`å®ç°çš„æ–‡ç« ã€‚ä½†æ˜¯å‰æ®µæ—¶é—´å—`TweenMax` `GSAP `è¿™äº›åŠ¨ç”»åº“çš„å½±å“ï¼Œæ€ç»´å½¢æˆæƒ¯æ€§ï¼Œä¼šå€¾å‘äºç”¨JSè§£å†³é—®é¢˜ã€‚æœ¬æ–‡ä»£ç å®ç°çš„å…³é”®åœ¨äº`Element.animate()`è¿™ä¸ªAPIï¼ŒæŒæ¡äº†è¿™ä¸ªAPIï¼Œå®ç°åŠ¨ç”»æ•ˆæœä¼šä»å®¹çš„å¤šã€‚

## å‚è€ƒèµ„æ–™Â·é¸£è°¢

[Deja-vuuu/vue-ele: ğŸ¥—ğŸ¥— vueæ•™ç¨‹ --- ä»0-1é«˜ä»¿é¥¿äº†ä¹ˆApp (github.com)](https://github.com/Deja-vuuu/vue-ele)

[ä½¿ç”¨åŸç”ŸElement.animateå®ç°æ–‡å­—ä¸å›¾ç‰‡åŠ¨ç”» - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7037109871208038437)

[Animation - Web API æ¥å£å‚è€ƒ | MDN (mozilla.org)](https://developer.mozilla.org/zh-CN/docs/Web/API/Animation)

[cubic-bezier(.17,.67,.83,.67) âœ¿ cubic-bezier.com](https://cubic-bezier.com/#.17,.67,.83,.67)
